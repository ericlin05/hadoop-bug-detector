Description

Running the following query 
Query

hive&amp;gt; set hive.plan.serialization.format=kryo;
hive&amp;gt; select count(*) from alltypes_orc where ts1 between '1969-12-31' and '1970-12-31';


Exception

2015-10-02 14:12:39,958 INFO  [main]: log.PerfLogger (PerfLogger.java:PerfLogBegin(121)) - &amp;lt;PERFLOG method=TezBuildDag from=org.apache.hadoop.hive.ql.exec.tez.TezTask&amp;gt;
2015-10-02 14:12:39,959 INFO  [main]: log.PerfLogger (PerfLogger.java:PerfLogBegin(121)) - &amp;lt;PERFLOG method=TezCreateVertex.Reducer 2 from=org.apache.hadoop.hive.ql.exec.tez.TezTask&amp;gt;
2015-10-02 14:12:39,959 INFO  [main]: log.PerfLogger (PerfLogger.java:PerfLogBegin(121)) - &amp;lt;PERFLOG method=serializePlan from=org.apache.hadoop.hive.ql.exec.Utilities&amp;gt;
2015-10-02 14:12:39,959 INFO  [main]: exec.Utilities (Utilities.java:serializePlan(942)) - Serializing ReduceWork via javaXML
2015-10-02 14:12:40,088 WARN  [main]: exec.Utilities (Utilities.java:exceptionThrown(1037)) - java.lang.InstantiationException: org.apache.hadoop.hive.ql.plan.OpTraits
	at java.lang.Class.newInstance(Class.java:359)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:75)
	at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:279)
	at java.beans.Statement.invokeInternal(Statement.java:292)
	at java.beans.Statement.access$000(Statement.java:58)
	at java.beans.Statement$2.run(Statement.java:185)
	at java.security.AccessController.doPrivileged(Native Method)
	at java.beans.Statement.invoke(Statement.java:182)
	at java.beans.Expression.getValue(Expression.java:153)
	at java.beans.Encoder.getValue(Encoder.java:105)
	at java.beans.Encoder.get(Encoder.java:252)
	at java.beans.PersistenceDelegate.writeObject(PersistenceDelegate.java:112)
	at java.beans.Encoder.writeObject(Encoder.java:74)
	at java.beans.XMLEncoder.writeObject(XMLEncoder.java:327)
	at java.beans.Encoder.writeExpression(Encoder.java:330)
	at java.beans.XMLEncoder.writeExpression(XMLEncoder.java:454)
	at java.beans.PersistenceDelegate.writeObject(PersistenceDelegate.java:115)
	at java.beans.Encoder.writeObject(Encoder.java:74)
	at java.beans.XMLEncoder.writeObject(XMLEncoder.java:327)
	at java.beans.Encoder.writeExpression(Encoder.java:330)
	at java.beans.XMLEncoder.writeExpression(XMLEncoder.java:454)
	at java.beans.DefaultPersistenceDelegate.doProperty(DefaultPersistenceDelegate.java:194)
	at java.beans.DefaultPersistenceDelegate.initBean(DefaultPersistenceDelegate.java:253)
	at java.beans.DefaultPersistenceDelegate.initialize(DefaultPersistenceDelegate.java:400)
	at java.beans.PersistenceDelegate.writeObject(PersistenceDelegate.java:118)
	at java.beans.Encoder.writeObject(Encoder.java:74)
	at java.beans.XMLEncoder.writeObject(XMLEncoder.java:327)
	at java.beans.Encoder.writeExpression(Encoder.java:330)
	at java.beans.XMLEncoder.writeExpression(XMLEncoder.java:454)
	at java.beans.PersistenceDelegate.writeObject(PersistenceDelegate.java:115)
	at java.beans.Encoder.writeObject(Encoder.java:74)
	at java.beans.XMLEncoder.writeObject(XMLEncoder.java:327)
	at java.beans.Encoder.writeExpression(Encoder.java:330)
	at java.beans.XMLEncoder.writeExpression(XMLEncoder.java:454)
	at java.beans.DefaultPersistenceDelegate.doProperty(DefaultPersistenceDelegate.java:194)
	at java.beans.DefaultPersistenceDelegate.initBean(DefaultPersistenceDelegate.java:253)
	at java.beans.DefaultPersistenceDelegate.initialize(DefaultPersistenceDelegate.java:400)
	at java.beans.PersistenceDelegate.writeObject(PersistenceDelegate.java:118)
	at java.beans.Encoder.writeObject(Encoder.java:74)
	at java.beans.XMLEncoder.writeObject(XMLEncoder.java:327)
	at java.beans.Encoder.writeExpression(Encoder.java:330)
	at java.beans.XMLEncoder.writeExpression(XMLEncoder.java:454)
	at java.beans.PersistenceDelegate.writeObject(PersistenceDelegate.java:115)
	at java.beans.Encoder.writeObject(Encoder.java:74)
	at java.beans.XMLEncoder.writeObject(XMLEncoder.java:327)
	at java.beans.Encoder.writeObject1(Encoder.java:258)
	at java.beans.Encoder.cloneStatement(Encoder.java:271)
	at java.beans.Encoder.writeStatement(Encoder.java:301)
	at java.beans.XMLEncoder.writeStatement(XMLEncoder.java:400)
	at java.beans.DefaultPersistenceDelegate.invokeStatement(DefaultPersistenceDelegate.java:217)
	at java.beans.MetaData$java_util_List_PersistenceDelegate.initialize(MetaData.java:654)
	at java.beans.PersistenceDelegate.initialize(PersistenceDelegate.java:212)
	at java.beans.DefaultPersistenceDelegate.initialize(DefaultPersistenceDelegate.java:398)
	at java.beans.PersistenceDelegate.writeObject(PersistenceDelegate.java:118)
	at java.beans.Encoder.writeObject(Encoder.java:74)
	at java.beans.XMLEncoder.writeObject(XMLEncoder.java:327)
	at java.beans.Encoder.writeExpression(Encoder.java:330)
	at java.beans.XMLEncoder.writeExpression(XMLEncoder.java:454)
	at java.beans.DefaultPersistenceDelegate.doProperty(DefaultPersistenceDelegate.java:194)
	at java.beans.DefaultPersistenceDelegate.initBean(DefaultPersistenceDelegate.java:253)
	at java.beans.DefaultPersistenceDelegate.initialize(DefaultPersistenceDelegate.java:400)
	at java.beans.PersistenceDelegate.writeObject(PersistenceDelegate.java:118)
	at java.beans.Encoder.writeObject(Encoder.java:74)
	at java.beans.XMLEncoder.writeObject(XMLEncoder.java:327)
	at java.beans.Encoder.writeExpression(Encoder.java:330)
	at java.beans.XMLEncoder.writeExpression(XMLEncoder.java:454)
	at java.beans.PersistenceDelegate.writeObject(PersistenceDelegate.java:115)
	at java.beans.Encoder.writeObject(Encoder.java:74)
	at java.beans.XMLEncoder.writeObject(XMLEncoder.java:327)
	at java.beans.Encoder.writeExpression(Encoder.java:330)
	at java.beans.XMLEncoder.writeExpression(XMLEncoder.java:454)
	at java.beans.DefaultPersistenceDelegate.doProperty(DefaultPersistenceDelegate.java:194)
	at java.beans.DefaultPersistenceDelegate.initBean(DefaultPersistenceDelegate.java:253)
	at java.beans.DefaultPersistenceDelegate.initialize(DefaultPersistenceDelegate.java:400)
	at java.beans.PersistenceDelegate.writeObject(PersistenceDelegate.java:118)
	at java.beans.Encoder.writeObject(Encoder.java:74)
	at java.beans.XMLEncoder.writeObject(XMLEncoder.java:327)
	at java.beans.Encoder.writeExpression(Encoder.java:330)
	at java.beans.XMLEncoder.writeExpression(XMLEncoder.java:454)
	at java.beans.PersistenceDelegate.writeObject(PersistenceDelegate.java:115)
	at java.beans.Encoder.writeObject(Encoder.java:74)
	at java.beans.XMLEncoder.writeObject(XMLEncoder.java:327)
	at java.beans.Encoder.writeObject1(Encoder.java:258)
	at java.beans.Encoder.cloneStatement(Encoder.java:271)
	at java.beans.Encoder.writeStatement(Encoder.java:301)
	at java.beans.XMLEncoder.writeStatement(XMLEncoder.java:400)
	at java.beans.XMLEncoder.writeObject(XMLEncoder.java:330)
	at org.apache.hadoop.hive.ql.exec.Utilities.serializeObjectByJavaXML(Utilities.java:1052)
	at org.apache.hadoop.hive.ql.exec.Utilities.serializePlan(Utilities.java:944)
	at org.apache.hadoop.hive.ql.exec.Utilities.serializePlan(Utilities.java:961)
	at org.apache.hadoop.hive.ql.exec.Utilities.setBaseWork(Utilities.java:707)
	at org.apache.hadoop.hive.ql.exec.Utilities.setReduceWork(Utilities.java:691)
	at org.apache.hadoop.hive.ql.exec.tez.DagUtils.createVertex(DagUtils.java:677)
	at org.apache.hadoop.hive.ql.exec.tez.DagUtils.createVertex(DagUtils.java:1082)
	at org.apache.hadoop.hive.ql.exec.tez.TezTask.build(TezTask.java:352)
	at org.apache.hadoop.hive.ql.exec.tez.TezTask.execute(TezTask.java:157)
	at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:160)
	at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:89)
	at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1732)
	at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1491)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1248)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1077)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1067)
	at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:213)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:165)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:376)
	at org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:736)
	at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:681)
	at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:621)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:221)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:136)




